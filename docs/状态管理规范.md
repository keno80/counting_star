# 状态管理规范（UiState / UiEvent / UiEffect）

## 目标

- 单向数据流：Event → ViewModel → State → UI
- 状态可复现：UI 只依赖 State 渲染
- 副作用可控：导航/Toast 等通过 Effect 触发

## 角色定义

### UiState

- 描述当前界面可见状态
- 必须是不可变数据类
- 包含加载态/空态/错误态所需字段

### UiEvent

- 用户操作或外部输入
- 只表达意图，不携带 UI 细节

### UiEffect

- 一次性副作用
- 包括导航、Toast、权限弹窗等
- 不作为状态保存

## 基本结构

- ViewModel 维护 StateFlow<UiState>
- UI 通过 collectAsState 订阅 State
- UI 通过 onEvent(...) 向 ViewModel 发送 UiEvent
- ViewModel 通过 Channel/SharedFlow 发射 UiEffect

## 约束

- UI 不直接修改 State
- ViewModel 不持有 Android View 引用
- 不在 UI 层执行业务逻辑
- 业务逻辑统一放到 UseCase

## 建议命名

- XxxUiState / XxxUiEvent / XxxUiEffect
- handleEvent(event: XxxUiEvent)
